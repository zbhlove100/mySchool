(function(a,b){function F(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:l,group:a.wrapper.id+"-moving",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b)})}function E(a){var b=this;b.owner=a,b._draggable=new e(a.wrapper,{filter:".k-resize-handle",group:a.wrapper.id+"-resizing",dragstart:g(b.dragstart,b),drag:g(b.drag,b),dragend:g(b.dragend,b)})}function D(b,c){var d=a(b);typeof c.scrollable!="undefined"&&c.scrollable===!1&&d.attr("style","overflow:hidden;"),c.contentUrl&&!z(c.contentUrl)&&d.html(j.iframe(c)),a(j.wrapper(c)).append(j.titlebar(c)).append(d).appendTo(document.body)}function B(){return a(k).filter(function(){var b=a(this);return b.is(q)&&A(b).options.modal})}function A(a){return a.children(m).data("kendoWindow")}function z(a){return a&&!y.test(a)}var c=window.kendo,d=c.ui.Component,e=c.ui.Draggable,f=c.fx,g=a.proxy,h=a.each,i=c.template,j,k=".k-window",l=".k-window-titlebar",m=".k-window-content",n=".k-overlay",o="k-loading",p="k-state-hover",q=":visible",r="open",s="activate",t="close",u="refresh",v="resize",w="error",x="overflow",y=/^([a-z]+:)?\/\//i,C=d.extend({init:function(b,c){var e=this,f,i=".k-window-titlebar .k-window-action",m,n,o=!1;d.fn.init.call(e,b,c),c=e.options,b=e.element,c.animation===!1&&(c.animation={open:{show:!0,effects:{}},close:{hide:!0,effects:{}}});if(!b.parent().is("body"))if(b.is(q))n=b.offset(),o=!0;else{var x=b.css("visibility"),y=b.css("display");b.css({visibility:"hidden",display:""}),n=b.offset(),b.css({visibility:x,display:y})}f=e.wrapper=b.closest(k);if(!b.is(".k-content")||!f[0])b.addClass("k-window-content k-content"),D(b,c),f=e.wrapper=b.closest(k),m=e.wrapper.find(l),m.css("margin-top",-m.outerHeight()),f.css("padding-top",m.outerHeight()),c.width&&f.width(c.width),c.height&&f.height(c.height),c.visible||f.hide();n&&(o?f.css({top:n.top,left:n.left}):f.css({top:n.top,left:n.left,visibility:"visible",display:"none"})),f.toggleClass("k-rtl",e.wrapper.closest(".k-rtl").length).appendTo(document.body),c.modal&&e._overlay(f.is(q)).css({opacity:.5}),f.delegate(i,"mouseenter",function(){a(this).addClass(p)}).delegate(i,"mouseleave",function(){a(this).removeClass(p)}).delegate(i,"click",g(e._windowActionHandler,e)),c.resizable&&(f.delegate(l,"dblclick",g(e.toggleMaximization,e)),h("n e s w se sw ne nw".split(" "),function(a,b){f.append(j.resizeHandle(b))}),e.resizing=new E(e)),c.draggable&&(e.dragging=new F(e)),e.bind([r,s,t,u,v,w],c),a(window).resize(g(e._onDocumentResize,e)),z(c.contentUrl)&&e._ajaxRequest(c.contentUrl),f.is(q)&&(e.trigger(r),e.trigger(s))},options:{animation:{open:{effects:{zoomIn:{},fadeIn:{}},duration:350,show:!0},close:{effects:{zoomOut:{properties:{scale:.7}},fadeOut:{}},duration:350,hide:!0}},title:"",actions:["Close"],modal:!1,resizable:!0,draggable:!0,minWidth:50,minHeight:50,visible:!0},_overlay:function(b){var c=a("body > .k-overlay"),d=a(document),e=this.wrapper[0];c.length==0?c=a("<div class='k-overlay' />").toggle(b).insertBefore(e):c.insertBefore(e).toggle(b);return c},_windowActionHandler:function(b){var c=a(b.target).closest(".k-window-action").find(".k-icon"),d=this;h({"k-close":d.close,"k-maximize":d.maximize,"k-restore":d.restore,"k-refresh":d.refresh},function(a,e){if(c.hasClass(a)){b.preventDefault(),e.call(d);return!1}})},center:function(){var b=this.wrapper,c=a(window);b.css({left:c.scrollLeft()+Math.max(0,(c.width()-b.width())/2),top:c.scrollTop()+Math.max(0,(c.height()-b.height())/2)});return this},title:function(b){var c=a(".k-window-titlebar > .k-window-title",this.wrapper);if(!b)return c.text();c.text(b);return this},content:function(a){var b=this.wrapper.children(m);if(!a)return b.html();b.html(a);return this},open:function(){var b=this,c=b.wrapper,d=b.options.animation.open,e=c.children(m),f=e.css(x);if(!b.trigger(r)){if(b.options.modal){var g=b._overlay(!1);d.duration?g.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:.5}}},duration:d.duration,show:!0}):g.css("opacity",.5).show()}c.is(q)||(e.css(x,"hidden"),c.show().kendoStop().kendoAnimate({effects:d.effects,duration:d.duration,complete:function(){b.trigger(s),e.css(x,f)}}))}b.options.isMaximized&&a("html, body").css(x,"hidden");return b},close:function(){var c=this,d=c.wrapper,e=c.options,f=e.animation.close,g,h,i;d.is(q)&&!c.trigger(t)&&(g=B(),h=e.modal&&g.length==1,i=e.modal?c._overlay(!0):a(b),h?f.duration?i.kendoStop().kendoAnimate({effects:{fadeOut:{properties:{opacity:0}}},duration:f.duration,hide:!0}):i.hide():g.length&&A(g.eq(g.length-2))._overlay(!0),d.kendoStop().kendoAnimate({effects:f.effects,duration:f.duration,complete:function(){d.hide()}})),c.options.isMaximized&&a("html, body").css(x,"");return c},toggleMaximization:function(b){b&&a(b.target).closest(".k-window-action").length>0||this[this.options.isMaximized?"restore":"maximize"]()},restore:function(){var b=this;if(!!b.options.isMaximized){b.wrapper.css({position:"absolute",left:b.restorationSettings.left,top:b.restorationSettings.top,width:b.restorationSettings.width,height:b.restorationSettings.height}).find(".k-resize-handle").show().end().find(".k-window-titlebar .k-restore").addClass("k-maximize").removeClass("k-restore"),a("html, body").css(x,""),b.options.isMaximized=!1,b.trigger(v);return b}},maximize:function(b){var c=this;if(!c.options.isMaximized){var d=c.wrapper;c.restorationSettings={left:d.position().left,top:d.position().top,width:d.width(),height:d.height()},d.css({left:0,top:0,position:"fixed"}).find(".k-resize-handle").hide().end().find(".k-window-titlebar .k-maximize").addClass("k-restore").removeClass("k-maximize"),a("html, body").css(x,"hidden"),c.options.isMaximized=!0,c._onDocumentResize();return c}},_onDocumentResize:function(){if(!!this.options.isMaximized){var b=this.wrapper;b.css({width:a(window).width(),height:a(window).height()}),this.trigger(v)}},refresh:function(a,b){var c=this;a=a||c.options.contentUrl,z(a)&&c._ajaxRequest(a,b);return c},_ajaxRequest:function(b,c){var d=this,e=d.wrapper.find(".k-window-titlebar .k-refresh"),f=setTimeout(function(){e.addClass(o)},100);a.ajax({type:"GET",url:b,dataType:"html",data:c||{},cache:!1,error:g(function(a,b){d.trigger(w)},d),complete:function(){clearTimeout(f),e.removeClass(o)},success:g(function(a,b){d.wrapper.children(m).html(a),d.trigger(u)},d)})},destroy:function(){var a=this,b,c;a.wrapper.remove(),b=B(),c=a.options.modal&&!b.length,c?a._overlay(!1).remove():b.length>0&&A(b.eq(b.length-2))._overlay(!0)}});j={wrapper:i("<div class='k-widget k-window'></div>"),titlebar:i("<div class='k-window-titlebar k-header'>&nbsp;<span class='k-window-title'>#= title #</span><div class='k-window-actions k-header'># for (var i = 0; i < actions.length; i++) { #<a href='\\#' class='k-window-action k-link'><span class='k-icon k-#= actions[i].toLowerCase() #'>#= actions[i] #</span></a># } #</div></div>"),iframe:i("<iframe src='#= contentUrl #' title='#= title #' frameborder='0' style='border:0;width:100%;height:100%;'>This page requires frames in order to show content</iframe>"),resizeHandle:i("<div class='k-resize-handle k-resize-#= data #'></div>")},E.prototype={dragstart:function(b){var c=this.owner,d=c.wrapper;c.elementPadding=parseInt(c.wrapper.css("padding-top")),c.initialCursorPosition=d.offset(),c.resizeDirection=b.currentTarget.prop("className").replace("k-resize-handle k-resize-","").split(""),c.initialSize={width:c.wrapper.width(),height:c.wrapper.height()},a("<div class='k-overlay' />").appendTo(c.wrapper),d.find(".k-resize-handle").not(b.currentTarget).hide(),a(document.body).css("cursor",b.currentTarget.css("cursor"))},drag:function(a){var b=this.owner,c=b.wrapper,d={e:function(){var d=a.pageX-b.initialCursorPosition.left;c.width(d<b.options.minWidth?b.options.minWidth:b.options.maxWidth&&d>b.options.maxWidth?b.options.maxWidth:d)},s:function(){var d=a.pageY-b.initialCursorPosition.top-b.elementPadding;c.height(d<b.options.minHeight?b.options.minHeight:b.options.maxHeight&&d>b.options.maxHeight?b.options.maxHeight:d)},w:function(){var d=b.initialCursorPosition.left+b.initialSize.width,e=d-a.pageX;c.css({left:a.pageX(d-b.options.minWidth)?d-b.options.minWidth:a.pageX<d-b.options.maxWidth?d-b.options.maxWidth:a.pageX,width:e<b.options.minWidth?b.options.minWidth:b.options.maxWidth&&e>b.options.maxWidth?b.options.maxWidth:e})},n:function(){var d=b.initialCursorPosition.top+b.initialSize.height,e=d-a.pageY;c.css({top:a.pageY>d-b.options.minHeight?d-b.options.minHeight:a.pageY<d-b.options.maxHeight?d-b.options.maxHeight:a.pageY,height:e<b.options.minHeight?b.options.minHeight:b.options.maxHeight&&e>b.options.maxHeight?b.options.maxHeight:e})}};h(b.resizeDirection,function(){d[this]()}),b.trigger(v)},dragend:function(b){var c=this.owner,d=c.wrapper;d.find(n).remove().end().find(".k-resize-handle").not(b.currentTarget).show(),a(document.body).css("cursor",""),b.keyCode==27&&d.css(c.initialCursorPosition).css(c.initialSize);return!1}},F.prototype={dragstart:function(b){var c=this.owner;c.initialWindowPosition=c.wrapper.position(),c.startPosition={left:b.pageX-c.initialWindowPosition.left,top:b.pageY-c.initialWindowPosition.top},a(".k-resize-handle",c.wrapper).hide(),a("<div class='k-overlay' />").appendTo(c.wrapper),a(document.body).css("cursor",b.currentTarget.css("cursor"))},drag:function(b){var c=this.owner,d={left:b.pageX-c.startPosition.left,top:Math.max(b.pageY-c.startPosition.top,0)};a(c.wrapper).css(d)},dragend:function(b){var c=this.owner;c.wrapper.find(".k-resize-handle").show().end().find(n).remove(),a(document.body).css("cursor",""),b.keyCode==27&&b.currentTarget.closest(k).css(c.initialWindowPosition);return!1}},c.ui.plugin("Window",C)})(jQuery)