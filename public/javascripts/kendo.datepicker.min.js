(function(a,b){var c=window.kendo,d=c.ui,e=c.support.touch,f=d.Component,g=c.parseDate,h=c.keys,i="<div />",j=e?"touchend":"click",k="open",l="close",m="change",n="navigate",o="dateView",p="disabled",q="k-state-selected",r="k-state-hover",s="mouseenter mouseleave",t=e?"touchstart":"mousedown",u=c.calendar,v=u.isInRange,w=u.restrictValue,x=a.proxy,y=Date,z,A=function(b){var c=this,e=document.body;z||(z=new d.Calendar(a(i).hide().appendTo(e))),c.calendar=z,c.options=b=b||{},c.popup=new d.Popup(a(i).addClass("k-calendar-container").appendTo(e),b),c.value(b.value)};A.prototype={_initCalendar:function(){var a=this,b=a.popup,c=a.options,d=a.calendar,e=d.element;e.data(o)!==a&&(e.appendTo(b.element).data(o,a).bind(j,x(a._click,a)).unbind(t).bind(t,c.clearBlurTimeout),d.options.min=c.min,d.options.max=c.max,d.options.depth=c.depth,d.options.startView=c.startView,d._currentView=c.startView,d.unbind(m).unbind(n).bind(n,x(a._navigate,a)).bind(m,c),e.show(),a.value(a._value))},open:function(){var a=this;a._initCalendar(),setTimeout(function(){a.popup.open()},0)},close:function(){this.popup.close()},min:function(a){var b=this,c=b.options,d=b.calendar;c.min=a,d.element.data(o)===b&&d.min(a)},max:function(a){var b=this,c=b.options,d=b.calendar;c.max=a,d.element.data(o)===b&&d.max(a)},toggle:function(){var a=this;a[a.popup.visible()?"close":"open"]()},navigate:function(a){var b=this,c=b.options,d=c.min,e=c.max,f=new y(b._viewedValue),g=b.calendar,i=g._currentView,j=g._view,k=a.keyCode,l,m,n;h.ESC==k?b.close():a.ctrlKey?h.RIGHT==k?(g.navigateToFuture(),n=!0):h.LEFT==k?(g.navigateToPast(),n=!0):h.UP==k?(g.navigateUp(),n=!0):h.DOWN==k&&(b._navigateDown(),n=!0):(h.RIGHT==k?(m=1,n=!0):h.LEFT==k?(m=-1,n=!0):h.UP==k?(m=i==="month"?-7:-4,n=!0):h.DOWN==k?(m=i==="month"?7:4,n=!0):h.ENTER==k?(n=!0,b._navigateDown()):h.HOME==k?(n=!0,b._viewedValue=f=w(j.first(f),c.min,c.max),g._focus(f)):h.END==k?(n=!0,b._viewedValue=f=w(j.last(f),c.min,c.max),g._focus(f)):h.PAGEUP==k?g.navigateToPast():h.PAGEDOWN==k&&g.navigateToFuture(),n&&a.preventDefault(),m&&(j.setDate(f,m),b._viewedValue=f=w(f,c.min,c.max),g._focus(f)))},value:function(a){var b=this,c=b.calendar,d=b.options;b._value=a,b._viewedValue=new y(w(a,d.min,d.max)),c.element.data(o)===b&&(c._focus(b._viewedValue),c.value(a))},_click:function(a){a.currentTarget.className.indexOf(q)!==-1&&this.close()},_navigate:function(){var a=this,b=a.calendar;a._viewedValue=new y(b._viewedValue),b._focus(b._viewedValue)},_navigateDown:function(){var a=this,b=a.calendar,c=b._viewedValue,d=b._table.find(".k-state-focused"),e=d.children(":first").data("value").split("/");e=new y(parseInt(e[2]),parseInt(e[0])-1,parseInt(e[1]));!d[0]||d.hasClass(q)?a.close():(b._view.setDate(c,e),b.navigateDown(c))}},c.DateView=A;var B=f.extend({init:function(b,d){var e=this,g,h;f.fn.init.call(e,b,d),b=e.element,d=e.options,d.format=d.format||c.culture().calendar.patterns.d,e._wrapper(),e.dateView=g=new A(a.extend({},d,{anchor:e.wrapper,change:function(){e._valid=!0,e.value(g.calendar.value()),e.trigger(m),e.close()},clearBlurTimeout:x(e._clearBlurTimeout,e)})),e._icon(),e.input=b.addClass("k-input").bind({keydown:x(e._keydown,e),focus:function(a){clearTimeout(e._bluring),e.input.parent().addClass("k-state-focused")},blur:x(e._blur,e)}),e.bind(m,d),e._valid=!0,e.enable(!b.is("[disabled]")),e.value(d.value||e.element.val())},options:{value:null,min:new Date(1900,0,1),max:new Date(2099,11,31),format:c.culture().calendar.patterns.d,startView:"month",depth:"month"},enable:function(a){var b=this,c=b._icon,d=b.wrapper.children(".k-picker-wrap"),e=b.element;c.unbind(j).unbind(t),a===!1?(d.addClass(p).unbind(s),e.attr(p,p)):(d.removeClass(p).bind(s,b._toggleHover),e.removeAttr(p),c.bind(j,x(b._click,b)).bind(t,x(b._clearBlurTimeout,b)))},open:function(){this.dateView.open()},close:function(){this.dateView.close()},min:function(a){var c=this,d=c.options;if(a===b)return d.min;a=g(a,d.format);!a||(d.min=new y(a),c.dateView.min(a))},max:function(a){var c=this,d=c.options;if(a===b)return d.max;a=g(a,d.format);!a||(d.max=new y(a),c.dateView.max(a))},value:function(a){var d=this,e=d.options,f=e.format;if(a===b)return d._value;a=g(a,f),v(a,e.min,e.max)||(a=null),d._value=a,d.dateView.value(a),d._valid&&d.element.val(c.toString(a,f)),d._valid=!0},_toggleHover:function(b){e||a(b.currentTarget).toggleClass(r,b.type==="mouseenter")},_blur:function(){var a=this;a._bluring=setTimeout(function(){a._change(a.element.val()),e||a.close(),a.input.parent().removeClass("k-state-focused")},100)},_clearBlurTimeout:function(){var a=this;setTimeout(function(){clearTimeout(a._bluring),a.element.focus()},0)},_click:function(){this.dateView.toggle()},_change:function(a){var b=this,c=b.options;a=g(a,c.format),a&&!v(a,c.min,c.max)&&(a=null),b._valid=a!==null,+a!=+b._value&&(b.value(a),b.trigger(m),b.element.trigger(m))},_keydown:function(a){var b=this,c=a.keyCode,d=b.dateView;a.altKey?h.DOWN==c?(b.open(),a.preventDefault()):h.UP==c&&(b.close(),a.preventDefault()):d.popup.visible()?d.navigate(a):h.ENTER==c&&b._change(a.currentTarget.value)},_icon:function(){var b=this,c=b.element,d;d=c.next("span.k-select"),d[0]||(d=a('<span class="k-select"><span class="k-icon k-icon-calendar">select</span></span>').insertAfter(c)),b._icon=d},_wrapper:function(){var a=this,b=a.element,c;c=b.parents(".k-datepicker"),c[0]||(c=b.wrap(i).parent().addClass("k-picker-wrap k-state-default"),c=c.wrap(i).parent()),c[0].style.cssText=b[0].style.cssText,b.css({width:"100%",height:"auto"}),a.wrapper=c.addClass("k-widget k-datepicker k-header")}});d.plugin("DatePicker",B)})(jQuery)